---
- name: Delete ISE Admin Nodes from VMware ESXi Host
  gather_facts: false
  hosts: localhost
  connection: local
  vars_files:
    - ../vars/main.yaml
    - ../vars/banners.yaml

  tasks:

#--------------------------------------------------------------------------
# This playbook will DELETE the VM from the ESXi host. The force command
# will delete a VM that is powered-on
#
#--------------------------------------------------------------------------

    - name: Delete ISE Primary Admin Node | ðŸ•‘ ~12s
      community.vmware.vmware_guest:
        validate_certs: no
        name: "vmware-admin"
        state: absent
        force: yes

    - name: Delete ISE Secondary Admin Node | ðŸ•‘ ~12s
      community.vmware.vmware_guest:
        validate_certs: no
        name: "vmware-sadmin"
        state: absent
        force: yes

    - name: Refresh inventory to ensure deleted instances are removed from inventory âŸ³
      ansible.builtin.meta: refresh_inventory

    - name: Skynet (a division of Cyberdyne Systems) Thanks You! ðŸ–§
      ansible.builtin.debug:
        msg: |
          â€ƒ                                       ,,                                        
          â€ƒ                                     ,####,                                      
          â€ƒ                                   ,########,                                    
          â€ƒ                                 ,############,                                 
          â€ƒ                               ,################,                               
          â€ƒ                             '####################'                              
          â€ƒ                          .#.  '################'  .#.                           
          â€ƒ                        ,#####,  '############'  ,#####,                        
          â€ƒ                      ,##########,  "######"  ,##########,                      
          â€ƒ                    ,##############,  "##"  ,##############,                    
          â€ƒ                  ,##################,    ,##################,                  
          â€ƒ                ,######################  ######################,               
          â€ƒ              ,########################  ########################,             
          â€ƒ            ,##########################  ##########################,           
          â€ƒ          ,############################  ############################,         
          â€ƒ        ,##############################  ##############################,       
          â€ƒ                                                                                
          â€ƒ       #@NNNNNNNNN ]$F ,g@$M @@      ]@F j@@@g    $@ @NNNNNNN% %%N$ @N&N
          â€ƒ       ]@@@@@@@@@m,]$@@@"    %&@@@@@@@$F ]$ "%$g  $@ @@@@@@@@@    ][           
          â€ƒ       ,ggggggggg$']$["*%@g,   yyyyyyy$F ]$    %Q@@@ @wwwwwwgw    ][            
          â€ƒ        "```"````` `"`    ```  `""""'``  ``      '`  ``"``````    ``   
          â€ƒ
          â€ƒ                         This instance has been TERMINATED